{% extends "layout.html" %}

{% set page_title = "Blog EtnaMonitor" %}
{% set page_description = "Approfondimenti, guide e aggiornamenti dal team EtnaMonitor sul monitoraggio del vulcano Etna." %}

{% block content %}
<section class="page-hero" aria-labelledby="blog-hero-title">
  <div class="container">
    <span class="pill pill--glow">Community</span>
    <h1 id="blog-hero-title">Blog EtnaMonitor</h1>
    <p class="lead">Analisi tecniche, tutorial guidati e best practice per sfruttare al massimo la piattaforma.</p>
    <div class="hero__actions">
      <a class="btn btn-primary" href="{{ url_for('community.feedback_portal') }}">Lascia un feedback</a>
      <a class="btn btn-secondary" href="{{ url_for('community.forum_home') }}">Vai al forum Q&amp;A</a>
    </div>
  </div>
</section>

<section class="blog-list" aria-label="Articoli pubblicati">
  <div class="container">
    {% if post_cards %}
      <div class="blog-grid">
        {% for card in post_cards %}
          {% set post = card.post %}
          <article class="blog-card">
            {% if post.hero_image_url or post.hero_image %}
              <img src="{{ post.hero_image_url or post.hero_image }}" alt="{{ post.title }}" loading="lazy" decoding="async" />
            {% endif %}
            <div class="blog-card__content">
              <span class="blog-card__date">{{ card.published_display }}</span>
              <h2><a href="{{ url_for('community.blog_detail', slug=post.slug) }}">{{ post.title }}</a></h2>
              {% if post.summary %}
                <p>{{ post.summary }}</p>
              {% endif %}
              <div class="blog-card__meta">
                <span class="blog-card__reading-time">Tempo di lettura: {{ card.reading_time }} min</span>
                {% if card.updated_display %}
                  <span class="blog-card__updated">Aggiornato: {{ card.updated_display }}</span>
                {% endif %}
                <a class="btn btn-ghost btn-sm" href="{{ url_for('community.blog_detail', slug=post.slug) }}">Leggi l'articolo</a>
              </div>
            </div>
          </article>
        {% endfor %}
      </div>
    {% else %}
      <p class="lead">Stiamo preparando i primi contenuti. Torna a trovarci o proponi un tema nel forum!</p>
    {% endif %}
  </div>
</section>
  {% if posts %}
    <script type="application/ld+json" nonce="{{ csp_nonce() }}">
      {
        "@context": "https://schema.org",
        "@type": "ItemList",
        "name": "Blog EtnaMonitor",
        "description": "Articoli, guide e approfondimenti sul monitoraggio dell'Etna",
        "itemListElement": [
          {% for post in posts %}
          {
            "@type": "ListItem",
            "position": {{ loop.index }},
            "url": {{ url_for('community.blog_detail', slug=post.slug, _external=True) | tojson }},
            "name": {{ post.title | tojson }}
          }{% if not loop.last %},{% endif %}
          {% endfor %}
        ]
      }
    </script>
  {% endif %}
{% endblock %}
